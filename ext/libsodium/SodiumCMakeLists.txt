cmake_minimum_required(VERSION 3.10)
project (sodium C)
set(CMAKE_C_STANDARD 11)

set(LIBSODIUM_INCLUDE_DIRS ${CMAKE_CURRENT_SOURCE_DIR}/builds/msvc ${CMAKE_CURRENT_SOURCE_DIR}/src/include/sodium)
FILE(GLOB_RECURSE DIRS LIST_DIRECTORIES true ${CMAKE_CURRENT_SOURCE_DIR}/src/libsodium/*)
foreach (DIR ${DIRS})
	if (IS_DIRECTORY ${DIR} AND NOT DIR MATCHES "\\.")
		set(LIBSODIUM_INCLUDE_DIRS ${LIBSODIUM_INCLUDE_DIRS} ${DIR})
	endif()
endforeach()
include_directories(${LIBSODIUM_INCLUDE_DIRS})

FILE(GLOB_RECURSE SOURCES src/**.c)

if(NOT ${CMAKE_SYSTEM_NAME} MATCHES "Windows")
	SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -DHAVE_SYS_RANDOM_H")
endif()
SET(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -DCONFIGURED -DSODIUM_STATIC -DSODIUM_EXPORT=")

add_library(${PROJECT_NAME} STATIC ${SOURCES})
